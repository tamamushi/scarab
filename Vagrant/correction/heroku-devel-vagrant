# -*- mode: python -*-
# This vagrant file made for enveroiment of python developement.
# vi: set ts=4 : 

VAGRANTFILE_API_VERSION = "2"

Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
	config.vm.box		= "centos65"
	config.vm.box_url	= "/Users/koube/Google\ ドライブ/vagrant_box/centos65-x86_64-20140116.box"
	config.vm.network "private_network", ip: "192.168.33.10"

	config.vm.synced_folder "./data", "/vagrant_data"
	config.vm.provider "virtualbox" do |vb|
		vb.memory = "1024"
	end

	config.vm.provision :shell, :inline =><<EOT
		## python2.7 install
		echo "[Starting installation Development tools]";
		yum groupinstall -y "Development tools"
		yum install -y wget

		## Need for make enveroiment of python 2.7.10 development.
		echo "[Starting installation various library for python]";
		yum install -y zlib-devel bzip2 bzip2-devel readline-devel sqlite sqlite-devel openssl-devel

		yum localinstall -y http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
		yum localinstall -y http://dl.iuscommunity.org/pub/ius/stable/CentOS/6/x86_64/ius-release-1.0-11.ius.centos6.noarch.rpm

		echo "[Starting installation Python 2.7]"
		yum install -y python27
		yum install -y python27-devel
		yum install -y python27-setuptools
 		yum install -y python27-mod_wsgi

		## Easy_install install
		curl -skL https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py | /usr/bin/python2.7
		## pip install
		curl -skL https://raw.githubusercontent.com/pypa/pip/master/contrib/get-pip.py | /usr/bin/python2.7

		pip install virtualenv
		pip install virtualenvwrapper

		## pyenv install
		git clone git://github.com/yyuu/pyenv.git ~/.pyenv
		git clone https://github.com/yyuu/pyenv-pip-rehash.git ~/.pyenv/plugins
		git clone git://github.com/yyuu/pyenv-virtualenv.git ~/.pyenv/plugins
		curl -skL https://raw.githubusercontent.com/tamamushi/scarab/master/Script/template/env.pyenv | cat >> ~/.bash_profile

		## Need for make enveroiment of ruby delvelopement.
		yum -y install libcurl-devel
		cd /usr/local/; git clone git://github.com/sstephenson/rbenv.git rbenv
		mkdir rbenv/shims rbenv/versions rbenv/plugins
		groupadd rbenv
		chgrp -R rbenv rbenv
		chmod -R g+rwxXs rbenv

		git clone git://github.com/sstephenson/ruby-build.git /usr/local/rbenv/plugins/ruby-build
		chgrp -R rbenv /usr/local/rbenv/plugins/ruby-build
		chmod -R g+rwxs /usr/local/rbenv/plugins/ruby-build

		git clone git://github.com/sstephenson/rbenv-default-gems.git /usr/local/rbenv/plugins/rbenv-default-gems
		chgrp -R rbenv /usr/local/rbenv/plugins/rbenv-default-gems
		chmod -R g+rwxs /usr/local/rbenv/plugins/rbenv-default-gems

		curl -skL https://raw.githubusercontent.com/tamamushi/scarab/master/Script/template/env.rbenv | cat > /etc/profile.d/rbenv.sh
		echo "bundler \nrdenv-rehash" >> /usr/local/rbenv/default-gems
EOT
	end
